% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SVGs_tools.R
\name{midpprog,SENNA-method}
\alias{midpprog,SENNA-method}
\title{Detect SVGs with peak expression at specific positions along the curve}
\usage{
\S4method{midpprog}{SENNA}(
  senna,
  pk,
  subj,
  weight = "box",
  FDR_level = 0.01,
  grad_cutoff = 0.1,
  active = FALSE,
  interval = sqrt(2),
  intensity = 1,
  cores = 1L
)
}
\arguments{
\item{senna}{A SENNA object}

\item{pk}{A numeric value (or vector) specifying the peak location along the normalized curve parameter}

\item{subj}{A character vector of gene names to be tested; if NULL, all genes are used}

\item{weight}{Type of weighting kernel to apply: `"gaussian"` (default) or `"box"`}

\item{FDR_level}{False discovery rate threshold used to filter significant genes}

\item{grad_cutoff}{Threshold on the absolute value of regression coefficients}

\item{active}{If `TRUE`, restricts analysis to spots selected by `ActiveIdent()`}

\item{interval}{Radius of the neighborhood to consider in box or Gaussian weighting (used only when `weight = "box"`)}

\item{intensity}{Scaling factor for Gaussian weights (used only when `weight = "gaussian"`)}

\item{cores}{Number of CPU cores to use for parallel processing (not supported on Windows)}
}
\value{
A SENNA object with results stored in `Gene$PeakSVGs`
}
\description{
Identify spatially variable genes (SVGs) whose expression levels peak at a specified location (`pk`) along the curve axis. 
For each peak position, a custom transformation of the curve parameter `t` is applied, and gene-wise regression is performed using either Gaussian or box weights.
}
