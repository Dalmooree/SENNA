% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SVGs_tools.R
\name{midpprog,mSENNA-method}
\alias{midpprog,mSENNA-method}
\title{Detect peak-like SVGs across multiple SENNA curves}
\usage{
\S4method{midpprog}{mSENNA}(
  senna,
  pk,
  subj,
  intervals,
  weight = "box",
  FDR_level = 0.01,
  grad_cutoff = 0.1,
  intensity = 1,
  active = FALSE,
  cores = 1L
)
}
\arguments{
\item{senna}{A `mSENNA` object}

\item{pk}{A numeric value or vector specifying peak locations along the normalized curve axis}

\item{subj}{A character vector of gene names to test; if `NULL`, all genes are tested}

\item{intervals}{A numeric vector of distance thresholds (one per curve) used to filter nearby spots}

\item{weight}{Type of weight to apply: `"gaussian"` or `"box"`}

\item{FDR_level}{False discovery rate threshold for selecting SVGs}

\item{grad_cutoff}{Minimum absolute regression coefficient to retain SVGs}

\item{intensity}{Scaling factor for Gaussian kernel (used only when `weight = "gaussian"`)}

\item{active}{If `TRUE`, use only cells activated by `ActiveIdent()`}

\item{cores}{Number of cores to use for parallel computation (not supported on Windows)}
}
\value{
A `mSENNA` object with peak SVG reports stored in `@msR`
}
\description{
Identify spatially variable genes (SVGs) that peak at a specified location (`pk`) along multiple curve axes in a `mSENNA` object.
The method performs piecewise transformation of the curve parameter `t` and runs weighted regression across batches.
}
